<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë°°ì°¨ ì˜¤ë” ë¶„ì„ ì‹œìŠ¤í…œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #0066cc 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
        }
        
        .logo {
            background: #1e3c72;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            margin-right: 25px;
            font-weight: bold;
            font-size: 18px;
            text-align: center;
            min-width: 200px;
            box-shadow: 0 5px 15px rgba(30, 60, 114, 0.3);
        }
        
        .logo .company-name {
            font-size: 24px;
            margin-bottom: 5px;
            letter-spacing: 2px;
        }
        
        .logo .tagline {
            font-size: 12px;
            opacity: 0.9;
            font-weight: normal;
        }
        
        h1 {
            color: #1e3c72;
            margin: 0;
            font-size: 2.2em;
            text-shadow: none;
        }
        
        .tabs {
            display: flex;
            background: rgba(255,255,255,0.15);
            border-radius: 12px;
            margin-bottom: 20px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.3);
            overflow: hidden;
        }
        
        .tab {
            flex: 1;
            padding: 18px 25px;
            text-align: center;
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            border-right: 1px solid rgba(255,255,255,0.1);
        }
        
        .tab:last-child {
            border-right: none;
        }
        
        .tab.active {
            background: linear-gradient(135deg, #0066cc 0%, #1e3c72 100%);
            box-shadow: 0 4px 15px rgba(0, 102, 204, 0.3);
            color: white;
        }
        
        .tab:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .tab-content {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            font-weight: bold;
            margin-bottom: 8px;
            color: #555;
        }
        
        input, select, textarea {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #0066cc;
            box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
        }
        
        .btn {
            background: linear-gradient(135deg, #0066cc 0%, #1e3c72 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 102, 204, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 102, 204, 0.4);
        }
        
        .stats-grid {
            display: flex !important;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 30px;
            justify-content: space-between;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #0066cc 0%, #1e3c72 100%);
            padding: 20px;
            border-radius: 15px;
            color: white;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0, 102, 204, 0.3);
            transition: transform 0.3s ease;
            flex: 1 1 calc(20% - 12px);
            min-width: 180px;
            min-height: 110px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        @media (max-width: 1200px) {
            .stat-card {
                flex: 1 1 calc(33.333% - 10px);
            }
        }
        
        @media (max-width: 768px) {
            .stat-card {
                flex: 1 1 calc(50% - 8px);
            }
        }
        
        @media (max-width: 480px) {
            .stat-card {
                flex: 1 1 100%;
            }
            .stats-grid {
                flex-direction: column;
            }
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-card h3 {
            font-size: 2.2em;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        .stat-card p {
            font-size: 1em;
            opacity: 0.9;
            margin: 0;
            font-weight: 500;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background: linear-gradient(135deg, #1e3c72 0%, #0066cc 100%);
            color: white;
            font-weight: bold;
        }
        
        tr:hover {
            background-color: #f8f9ff;
        }
        
        .delete-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .edit-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            margin-right: 5px;
        }
        
        .edit-btn:hover {
            background: #218838;
        }
        
        .save-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            margin-right: 5px;
        }
        
        .save-btn:hover {
            background: #0069d9;
        }
        
        .cancel-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            margin-right: 5px;
        }
        
        .cancel-btn:hover {
            background: #5a6268;
        }
        
        .edit-input {
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
            width: 80px;
            font-size: 12px;
        }
        
        .edit-input-wide {
            width: 100px;
        }
        
        .edit-select {
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
            width: 120px;
            font-size: 12px;
        }
        
        .edit-input-memo {
            width: 200px;
            height: 60px;
            resize: vertical;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-size: 12px;
        }
        
        .export-section {
            text-align: center;
            margin-top: 30px;
            padding: 30px;
            background: linear-gradient(135deg, #0066cc 0%, #1e3c72 100%);
            border-radius: 15px;
            color: white;
        }
        
        .export-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 10px;
            transition: all 0.3s ease;
        }
        
        .export-btn:hover {
            background: white;
            color: #0066cc;
        }
        
        .filter-section {
            background: rgba(255,255,255,0.9);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .filter-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .filter-group label {
            font-weight: bold;
            margin: 0;
            white-space: nowrap;
        }
        
        .filter-group select,
        .filter-group input {
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #ddd;
            min-width: 150px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="company-name">TAEYOUNGWIN</div>
                <div class="tagline">ë‚´ì¼ì˜ í¬ë§ì´ ì˜¤ëŠ˜ì„ ë§Œë“  (ì£¼)íƒœì˜ìœˆ</div>
            </div>
            <h1>ğŸšš ë°°ì°¨ ì˜¤ë” ë¶„ì„ ì‹œìŠ¤í…œ</h1>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="showTab('input')">ğŸ“ ë°ì´í„° ì…ë ¥</button>
            <button class="tab" onclick="showTab('analysis')">ğŸ“Š í†µê³„ ë¶„ì„</button>
            <button class="tab" onclick="showTab('history')">ğŸ“‹ ì´ë ¥ ê´€ë¦¬</button>
        </div>
        
        <!-- ë°ì´í„° ì…ë ¥ íƒ­ -->
        <div id="input" class="tab-content active">
            <h2 style="margin-bottom: 25px; color: #1e3c72;">ì¼ì¼ ë°°ì°¨ ì˜¤ë” ì…ë ¥</h2>
            
            <form id="orderForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="date">ë‚ ì§œ</label>
                        <input type="date" id="date" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="branch">ì§€ì‚¬ëª…</label>
                        <select id="branch" required>
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="ì²­ì£¼ì§€ì‚¬">ì²­ì£¼ì§€ì‚¬</option>
                            <option value="ì¶©ì£¼ì§€ì‚¬">ì¶©ì£¼ì§€ì‚¬</option>
                            <option value="ì²œì•ˆì§€ì‚¬">ì²œì•ˆì§€ì‚¬</option>
                            <option value="ì•„ì‚°ì§€ì‚¬">ì•„ì‚°ì§€ì‚¬</option>
                            <option value="ì„œì‚°ì§€ì‚¬">ì„œì‚°ì§€ì‚¬</option>
                            <option value="ì„¸ì¢…ì§€ì‚¬">ì„¸ì¢…ì§€ì‚¬</option>
                            <option value="ë‚¨ëŒ€ì „ì§€ì‚¬">ë‚¨ëŒ€ì „ì§€ì‚¬</option>
                            <option value="ë¶ëŒ€ì „ì§€ì‚¬">ë¶ëŒ€ì „ì§€ì‚¬</option>
                            <option value="ëŒ€ì „ì˜ì—…íŒ€ì„¼í„°">ëŒ€ì „ì˜ì—…íŒ€ì„¼í„°</option>
                            <option value="ë‚¨ì–‘ì£¼ì§€ì‚¬">ë‚¨ì–‘ì£¼ì§€ì‚¬</option>
                            <option value="ìµì‚°ì§€ì‚¬">ìµì‚°ì§€ì‚¬</option>
                            <option value="ë©€í‹°ì»¤ë¨¸ìŠ¤">ë©€í‹°ì»¤ë¨¸ìŠ¤</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="morningOrder">ê°€ì˜¤ë” ìˆ˜ëŸ‰</label>
                        <input type="number" id="morningOrder" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="tempOrderTime">ê°€ì˜¤ë” ì‹œê°„</label>
                        <input type="time" id="tempOrderTime" value="09:00">
                    </div>
                    
                    <div class="form-group">
                        <label for="confirmedOrder">í™•ì •ì˜¤ë” ìˆ˜ëŸ‰</label>
                        <input type="number" id="confirmedOrder" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="confirmedOrderTime">í™•ì •ì˜¤ë” ì‹œê°„</label>
                        <input type="time" id="confirmedOrderTime" value="15:00">
                    </div>
                    
                    <div class="form-group">
                        <label for="cancelled">ì·¨ì†Œëœ ì˜¤ë”</label>
                        <input type="number" id="cancelled" min="0" value="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="changed">ë³€ê²½ëœ ì˜¤ë”</label>
                        <input type="number" id="changed" min="0" value="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="added">ì¶”ê°€ëœ ì˜¤ë”</label>
                        <input type="number" id="added" min="0" value="0">
                    </div>
                </div>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label for="memo">ìƒì„¸ ë©”ëª¨</label>
                    <textarea id="memo" rows="3" placeholder="ì¶”ê°€ì ì¸ ìƒí™©ì´ë‚˜ íŠ¹ì´ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                </div>
                
                <button type="submit" class="btn" style="margin-top: 20px;">ğŸ“Š ë°ì´í„° ì €ì¥</button>
            </form>
        </div>
        
        <!-- í†µê³„ ë¶„ì„ íƒ­ -->
        <div id="analysis" class="tab-content">
            <h2 style="margin-bottom: 25px; color: #1e3c72;">ğŸ“ˆ í†µê³„ ë¶„ì„</h2>
            
            <!-- í†µê³„ í•„í„° ì„¹ì…˜ -->
            <div class="filter-section">
                <div class="filter-group">
                    <label>ê¸°ê°„ ì„ íƒ:</label>
                    <select id="statsPeriod" onchange="toggleStatsFilters()">
                        <option value="all">ì „ì²´</option>
                        <option value="monthly">ì›”ë³„</option>
                        <option value="daily">ì¼ë³„</option>
                    </select>
                </div>
                <div class="filter-group" id="monthFilter" style="display: none;">
                    <label>ì›” ì„ íƒ:</label>
                    <input type="month" id="selectedMonth" onchange="updateStatistics()">
                </div>
                <div class="filter-group" id="dateFilter" style="display: none;">
                    <label>ë‚ ì§œ ì„ íƒ:</label>
                    <input type="date" id="selectedDate" onchange="updateStatistics()">
                </div>
                <div class="filter-group">
                    <label>ì§€ì‚¬ ì„ íƒ:</label>
                    <select id="statsBranch" onchange="updateStatistics()">
                        <option value="">ì „ì²´ ì§€ì‚¬</option>
                        <option value="ì²­ì£¼ì§€ì‚¬">ì²­ì£¼ì§€ì‚¬</option>
                        <option value="ì¶©ì£¼ì§€ì‚¬">ì¶©ì£¼ì§€ì‚¬</option>
                        <option value="ì²œì•ˆì§€ì‚¬">ì²œì•ˆì§€ì‚¬</option>
                        <option value="ì•„ì‚°ì§€ì‚¬">ì•„ì‚°ì§€ì‚¬</option>
                        <option value="ì„œì‚°ì§€ì‚¬">ì„œì‚°ì§€ì‚¬</option>
                        <option value="ì„¸ì¢…ì§€ì‚¬">ì„¸ì¢…ì§€ì‚¬</option>
                        <option value="ë‚¨ëŒ€ì „ì§€ì‚¬">ë‚¨ëŒ€ì „ì§€ì‚¬</option>
                        <option value="ë¶ëŒ€ì „ì§€ì‚¬">ë¶ëŒ€ì „ì§€ì‚¬</option>
                        <option value="ëŒ€ì „ì˜ì—…íŒ€ì„¼í„°">ëŒ€ì „ì˜ì—…íŒ€ì„¼í„°</option>
                        <option value="ë‚¨ì–‘ì£¼ì§€ì‚¬">ë‚¨ì–‘ì£¼ì§€ì‚¬</option>
                        <option value="ìµì‚°ì§€ì‚¬">ìµì‚°ì§€ì‚¬</option>
                        <option value="ë©€í‹°ì»¤ë¨¸ìŠ¤">ë©€í‹°ì»¤ë¨¸ìŠ¤</option>
                    </select>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="totalOrders">0</h3>
                    <p>ì´ í™•ì •ì˜¤ë” ìˆ˜</p>
                </div>
                <div class="stat-card">
                    <h3 id="avgAccuracy">0%</h3>
                    <p>í‰ê·  ì •í™•ë¥ </p>
                </div>
                <div class="stat-card">
                    <h3 id="totalCancelled">0</h3>
                    <p>ì´ ì·¨ì†Œ ìˆ˜</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalChanged">0</h3>
                    <p>ì´ ë³€ê²½ ìˆ˜</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalAdded">0</h3>
                    <p>ì´ ì¶”ê°€ ìˆ˜</p>
                </div>
            </div>
            
            <h3 style="margin: 30px 0 15px 0; color: #1e3c72;">ì§€ì‚¬ë³„ í†µê³„</h3>
            <table id="branchStatsTable">
                <thead>
                    <tr>
                        <th>ì§€ì‚¬ëª…</th>
                        <th>ì´ í™•ì •ì˜¤ë”</th>
                        <th>ì •í™•ë¥ </th>
                        <th>ì·¨ì†Œìœ¨</th>
                        <th>ë³€ê²½ìœ¨</th>
                        <th>ì¶”ê°€ìœ¨</th>
                    </tr>
                </thead>
                <tbody id="branchStatsBody">
                </tbody>
            </table>
        </div>
        
        <!-- ì´ë ¥ ê´€ë¦¬ íƒ­ -->
        <div id="history" class="tab-content">
            <h2 style="margin-bottom: 25px; color: #1e3c72;">ğŸ“‹ ì…ë ¥ ì´ë ¥</h2>
            
            <!-- ì´ë ¥ í•„í„° ì„¹ì…˜ -->
            <div class="filter-section">
                <div class="filter-group">
                    <label>ê¸°ê°„ ì„ íƒ:</label>
                    <select id="historyPeriod" onchange="toggleHistoryFilters()">
                        <option value="all">ì „ì²´</option>
                        <option value="monthly">ì›”ë³„</option>
                        <option value="daily">ì¼ë³„</option>
                    </select>
                </div>
                <div class="filter-group" id="historyMonthFilter" style="display: none;">
                    <label>ì›” ì„ íƒ:</label>
                    <input type="month" id="historySelectedMonth" onchange="filterHistory()">
                </div>
                <div class="filter-group" id="historyDateFilter" style="display: none;">
                    <label>ë‚ ì§œ ì„ íƒ:</label>
                    <input type="date" id="historySelectedDate" onchange="filterHistory()">
                </div>
                <div class="filter-group">
                    <label>ì§€ì‚¬ ì„ íƒ:</label>
                    <select id="filterBranch" onchange="filterHistory()">
                        <option value="">ì „ì²´ ì§€ì‚¬</option>
                        <option value="ì²­ì£¼ì§€ì‚¬">ì²­ì£¼ì§€ì‚¬</option>
                        <option value="ì¶©ì£¼ì§€ì‚¬">ì¶©ì£¼ì§€ì‚¬</option>
                        <option value="ì²œì•ˆì§€ì‚¬">ì²œì•ˆì§€ì‚¬</option>
                        <option value="ì•„ì‚°ì§€ì‚¬">ì•„ì‚°ì§€ì‚¬</option>
                        <option value="ì„œì‚°ì§€ì‚¬">ì„œì‚°ì§€ì‚¬</option>
                        <option value="ì„¸ì¢…ì§€ì‚¬">ì„¸ì¢…ì§€ì‚¬</option>
                        <option value="ë‚¨ëŒ€ì „ì§€ì‚¬">ë‚¨ëŒ€ì „ì§€ì‚¬</option>
                        <option value="ë¶ëŒ€ì „ì§€ì‚¬">ë¶ëŒ€ì „ì§€ì‚¬</option>
                        <option value="ëŒ€ì „ì˜ì—…íŒ€ì„¼í„°">ëŒ€ì „ì˜ì—…íŒ€ì„¼í„°</option>
                        <option value="ë‚¨ì–‘ì£¼ì§€ì‚¬">ë‚¨ì–‘ì£¼ì§€ì‚¬</option>
                        <option value="ìµì‚°ì§€ì‚¬">ìµì‚°ì§€ì‚¬</option>
                        <option value="ë©€í‹°ì»¤ë¨¸ìŠ¤">ë©€í‹°ì»¤ë¨¸ìŠ¤</option>
                    </select>
                </div>
            </div>
            
            <table id="historyTable">
                <thead>
                    <tr>
                        <th>ë‚ ì§œ</th>
                        <th>ì§€ì‚¬ëª…</th>
                        <th>ê°€ì˜¤ë”ìˆ˜ëŸ‰</th>
                        <th>ê°€ì˜¤ë”ì‹œê°„</th>
                        <th>í™•ì •ì˜¤ë”ìˆ˜ëŸ‰</th>
                        <th>í™•ì •ì˜¤ë”ì‹œê°„</th>
                        <th>ì·¨ì†Œ</th>
                        <th>ë³€ê²½</th>
                        <th>ì¶”ê°€</th>
                        <th>ì •í™•ë¥ </th>
                        <th>ë©”ëª¨</th>
                        <th>ê´€ë¦¬</th>
                    </tr>
                </thead>
                <tbody id="historyBody">
                </tbody>
            </table>
            
            <div class="export-section">
                <h3 style="margin-bottom: 20px;">ğŸ“¤ ë°ì´í„° ë‚´ë³´ë‚´ê¸°</h3>
                <p style="margin-bottom: 20px;">ìˆ˜ì§‘ëœ ë°ì´í„°ë¥¼ ë‹¤ì–‘í•œ í˜•íƒœë¡œ ë‚´ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                <button class="export-btn" onclick="exportToCSV()">CSV íŒŒì¼ë¡œ ë‚´ë³´ë‚´ê¸°</button>
                <button class="export-btn" onclick="exportToJSON()">JSON íŒŒì¼ë¡œ ë‚´ë³´ë‚´ê¸°</button>
                <button class="export-btn" onclick="printReport()">ë³´ê³ ì„œ ì¸ì‡„</button>
            </div>
        </div>
    </div>

    <script>
        let editingIndex = -1; // í˜„ì¬ í¸ì§‘ ì¤‘ì¸ í–‰ì˜ ì¸ë±ìŠ¤
        
        // ìˆ˜ì • ì‹œì‘ í•¨ìˆ˜
        function startEdit(index) {
            if (editingIndex !== -1) {
                alert('ë‹¤ë¥¸ í•­ëª©ì„ í¸ì§‘ ì¤‘ì…ë‹ˆë‹¤. ë¨¼ì € ì €ì¥í•˜ê±°ë‚˜ ì·¨ì†Œí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            editingIndex = index;
            const item = orderData[index];
            const row = document.querySelector(`tr[data-index="${index}"]`);
            
            if (!row) return;
            
            // ê° ì…€ì„ í¸ì§‘ ê°€ëŠ¥í•œ ì…ë ¥ í•„ë“œë¡œ ë³€ê²½
            row.innerHTML = `
                <td><input type="date" value="${item.date}" class="edit-input-wide" id="edit-date-${index}"></td>
                <td>
                    <select class="edit-select" id="edit-branch-${index}">
                        <option value="ì²­ì£¼ì§€ì‚¬" ${item.branch === 'ì²­ì£¼ì§€ì‚¬' ? 'selected' : ''}>ì²­ì£¼ì§€ì‚¬</option>
                        <option value="ì¶©ì£¼ì§€ì‚¬" ${item.branch === 'ì¶©ì£¼ì§€ì‚¬' ? 'selected' : ''}>ì¶©ì£¼ì§€ì‚¬</option>
                        <option value="ì²œì•ˆì§€ì‚¬" ${item.branch === 'ì²œì•ˆì§€ì‚¬' ? 'selected' : ''}>ì²œì•ˆì§€ì‚¬</option>
                        <option value="ì•„ì‚°ì§€ì‚¬" ${item.branch === 'ì•„ì‚°ì§€ì‚¬' ? 'selected' : ''}>ì•„ì‚°ì§€ì‚¬</option>
                        <option value="ì„œì‚°ì§€ì‚¬" ${item.branch === 'ì„œì‚°ì§€ì‚¬' ? 'selected' : ''}>ì„œì‚°ì§€ì‚¬</option>
                        <option value="ì„¸ì¢…ì§€ì‚¬" ${item.branch === 'ì„¸ì¢…ì§€ì‚¬' ? 'selected' : ''}>ì„¸ì¢…ì§€ì‚¬</option>
                        <option value="ë‚¨ëŒ€ì „ì§€ì‚¬" ${item.branch === 'ë‚¨ëŒ€ì „ì§€ì‚¬' ? 'selected' : ''}>ë‚¨ëŒ€ì „ì§€ì‚¬</option>
                        <option value="ë¶ëŒ€ì „ì§€ì‚¬" ${item.branch === 'ë¶ëŒ€ì „ì§€ì‚¬' ? 'selected' : ''}>ë¶ëŒ€ì „ì§€ì‚¬</option>
                        <option value="ëŒ€ì „ì˜ì—…íŒ€ì„¼í„°" ${item.branch === 'ëŒ€ì „ì˜ì—…íŒ€ì„¼í„°' ? 'selected' : ''}>ëŒ€ì „ì˜ì—…íŒ€ì„¼í„°</option>
                        <option value="ë‚¨ì–‘ì£¼ì§€ì‚¬" ${item.branch === 'ë‚¨ì–‘ì£¼ì§€ì‚¬' ? 'selected' : ''}>ë‚¨ì–‘ì£¼ì§€ì‚¬</option>
                        <option value="ìµì‚°ì§€ì‚¬" ${item.branch === 'ìµì‚°ì§€ì‚¬' ? 'selected' : ''}>ìµì‚°ì§€ì‚¬</option>
                        <option value="ë©€í‹°ì»¤ë¨¸ìŠ¤" ${item.branch === 'ë©€í‹°ì»¤ë¨¸ìŠ¤' ? 'selected' : ''}>ë©€í‹°ì»¤ë¨¸ìŠ¤</option>
                    </select>
                </td>
                <td><input type="number" value="${item.morningOrder}" min="0" class="edit-input" id="edit-morning-${index}"></td>
                <td><input type="time" value="${item.tempOrderTime || ''}" class="edit-input" id="edit-temptime-${index}"></td>
                <td><input type="number" value="${item.confirmedOrder}" min="0" class="edit-input" id="edit-confirmed-${index}"></td>
                <td><input type="time" value="${item.confirmedOrderTime || ''}" class="edit-input" id="edit-confirmedtime-${index}"></td>
                <td><input type="number" value="${item.cancelled}" min="0" class="edit-input" id="edit-cancelled-${index}"></td>
                <td><input type="number" value="${item.changed}" min="0" class="edit-input" id="edit-changed-${index}"></td>
                <td><input type="number" value="${item.added}" min="0" class="edit-input" id="edit-added-${index}"></td>
                <td><span style="color: ${item.accuracy >= 90 ? '#28a745' : item.accuracy >= 70 ? '#ffc107' : '#dc3545'}">${item.accuracy}%</span></td>
                <td><textarea class="edit-input-memo" id="edit-memo-${index}" placeholder="ë©”ëª¨ ì…ë ¥">${item.memo || ''}</textarea></td>
                <td>
                    <button class="save-btn" onclick="saveEdit(${index})">ì €ì¥</button>
                    <button class="cancel-btn" onclick="cancelEdit(${index})">ì·¨ì†Œ</button>
                </td>
            `;
        }
        
        // ìˆ˜ì • ì €ì¥ í•¨ìˆ˜
        function saveEdit(index) {
            const newDate = document.getElementById(`edit-date-${index}`).value;
            const newBranch = document.getElementById(`edit-branch-${index}`).value;
            const newMorning = parseInt(document.getElementById(`edit-morning-${index}`).value) || 0;
            const newConfirmed = parseInt(document.getElementById(`edit-confirmed-${index}`).value) || 0;
            const newCancelled = parseInt(document.getElementById(`edit-cancelled-${index}`).value) || 0;
            const newChanged = parseInt(document.getElementById(`edit-changed-${index}`).value) || 0;
            const newAdded = parseInt(document.getElementById(`edit-added-${index}`).value) || 0;
            const newTempTime = document.getElementById(`edit-temptime-${index}`).value;
            const newConfirmedTime = document.getElementById(`edit-confirmedtime-${index}`).value;
            const newMemo = document.getElementById(`edit-memo-${index}`).value;
            
            // ì…ë ¥ê°’ ê²€ì¦
            if (!newDate || !newBranch) {
                alert('ë‚ ì§œì™€ ì§€ì‚¬ëª…ì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.');
                return;
            }
            
            // ë™ì¼í•œ ë‚ ì§œì™€ ì§€ì‚¬ì˜ ë‹¤ë¥¸ ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸ (í˜„ì¬ í¸ì§‘ ì¤‘ì¸ í•­ëª© ì œì™¸)
            const existingIndex = orderData.findIndex((item, idx) => 
                idx !== index && item.date === newDate && item.branch === newBranch
            );
            
            if (existingIndex !== -1) {
                alert('í•´ë‹¹ ë‚ ì§œì™€ ì§€ì‚¬ì˜ ë°ì´í„°ê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.');
                return;
            }
            
            // ì •í™•ë¥  ê³„ì‚° (ìˆ˜ì •ëœ ê³µì‹ ì ìš©)
            const newAccuracy = calculateAccuracy(newMorning, newConfirmed, newCancelled, newChanged);
            
            // ì¶”ê°€ëœ ì˜¤ë” ìë™ ê³„ì‚°
            const autoAdded = Math.max(0, newConfirmed - newMorning);
            const finalAdded = Math.max(newAdded, autoAdded);
            
            // ë°ì´í„° ì—…ë°ì´íŠ¸
            orderData[index] = {
                ...orderData[index],
                date: newDate,
                branch: newBranch,
                morningOrder: newMorning,
                confirmedOrder: newConfirmed,
                cancelled: newCancelled,
                changed: newChanged,
                added: finalAdded,
                tempOrderTime: newTempTime,
                confirmedOrderTime: newConfirmedTime,
                memo: newMemo,
                accuracy: newAccuracy
            };
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
            try {
                localStorage.setItem('orderData', JSON.stringify(orderData));
                console.log('ìˆ˜ì •ëœ ë°ì´í„° ì €ì¥ ì™„ë£Œ:', orderData[index]); // ë””ë²„ê¹…ìš©
                
                // í¸ì§‘ ëª¨ë“œ ì¢…ë£Œ
                editingIndex = -1;
                
                // í…Œì´ë¸” ìƒˆë¡œê³ ì¹¨
                filterHistory();
                updateStatistics();
                
                alert('ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!');
            } catch (error) {
                console.error('ìˆ˜ì • ì €ì¥ ì˜¤ë¥˜:', error);
                alert('ë°ì´í„° ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }
        
        // ìˆ˜ì • ì·¨ì†Œ í•¨ìˆ˜
        function cancelEdit(index) {
            editingIndex = -1;
            filterHistory(); // ì›ë˜ ìƒíƒœë¡œ ë˜ëŒë¦¬ê¸°
        }
        
        // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
        document.getElementById('date').value = new Date().toISOString().split('T')[0];
        
        // íƒ­ ì „í™˜ í•¨ìˆ˜
        function showTab(tabName) {
            // ëª¨ë“  íƒ­ê³¼ ì»¨í…ì¸  ë¹„í™œì„±í™”
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // ì„ íƒëœ íƒ­ê³¼ ì»¨í…ì¸  í™œì„±í™”
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            // í†µê³„ ë¶„ì„ íƒ­ì´ í™œì„±í™”ë˜ë©´ í†µê³„ ì—…ë°ì´íŠ¸
            if (tabName === 'analysis') {
                updateStatistics();
            }
            
            // ì´ë ¥ ê´€ë¦¬ íƒ­ì´ í™œì„±í™”ë˜ë©´ ì´ë ¥ ì—…ë°ì´íŠ¸
            if (tabName === 'history') {
                updateHistory();
            }
        }
        
        // í¼ ì œì¶œ ì²˜ë¦¬
        document.getElementById('orderForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸°
            const dateValue = document.getElementById('date').value;
            const branchValue = document.getElementById('branch').value;
            const morningOrderValue = document.getElementById('morningOrder').value;
            const confirmedOrderValue = document.getElementById('confirmedOrder').value;
            const cancelledValue = document.getElementById('cancelled').value;
            const changedValue = document.getElementById('changed').value;
            const addedValue = document.getElementById('added').value;
            const tempOrderTimeValue = document.getElementById('tempOrderTime').value;
            const confirmedOrderTimeValue = document.getElementById('confirmedOrderTime').value;
            const memoValue = document.getElementById('memo').value;
            
            // ì…ë ¥ê°’ ê²€ì¦
            if (!dateValue || !branchValue || !morningOrderValue || !confirmedOrderValue) {
                alert('ë‚ ì§œ, ì§€ì‚¬ëª…, ê°€ì˜¤ë” ìˆ˜ëŸ‰, í™•ì •ì˜¤ë” ìˆ˜ëŸ‰ì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.');
                return;
            }
            
            const morningOrder = parseInt(morningOrderValue) || 0;
            const confirmedOrder = parseInt(confirmedOrderValue) || 0;
            const cancelled = parseInt(cancelledValue) || 0;
            const changed = parseInt(changedValue) || 0;
            const added = parseInt(addedValue) || 0;
            
            // ì¶”ê°€ëœ ì˜¤ë” ìë™ ê³„ì‚° (í™•ì •ì˜¤ë”ê°€ ê°€ì˜¤ë”ë³´ë‹¤ ë§ì„ ë•Œ)
            const autoAdded = Math.max(0, confirmedOrder - morningOrder);
            const finalAdded = Math.max(added, autoAdded); // ì…ë ¥ê°’ê³¼ ìë™ê³„ì‚°ê°’ ì¤‘ í° ê°’ ì‚¬ìš©
            
            const formData = {
                date: dateValue,
                branch: branchValue,
                morningOrder: morningOrder,
                confirmedOrder: confirmedOrder,
                cancelled: cancelled,
                changed: changed,
                added: finalAdded,
                tempOrderTime: tempOrderTimeValue,
                confirmedOrderTime: confirmedOrderTimeValue,
                memo: memoValue,
                accuracy: calculateAccuracy(morningOrder, confirmedOrder, cancelled, changed)
            };
            
            console.log('ì €ì¥í•  ë°ì´í„°:', formData); // ë””ë²„ê¹…ìš©
            console.log('ì •í™•ë¥  ê³„ì‚°:', `ê°€ì˜¤ë” ${morningOrder}, í™•ì •ì˜¤ë” ${confirmedOrder}, ì·¨ì†Œ ${cancelled}, ë³€ê²½ ${changed}, ì¶”ê°€ ${finalAdded} â†’ ì •í™•ë¥  ${formData.accuracy}%`); // ë””ë²„ê¹…ìš©
            
            // ë™ì¼í•œ ë‚ ì§œì™€ ì§€ì‚¬ì˜ ê¸°ì¡´ ë°ì´í„° í™•ì¸
            const existingIndex = orderData.findIndex(item => 
                item.date === formData.date && item.branch === formData.branch
            );
            
            if (existingIndex !== -1) {
                if (confirm('í•´ë‹¹ ë‚ ì§œì™€ ì§€ì‚¬ì˜ ë°ì´í„°ê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤. ë®ì–´ì“°ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    orderData[existingIndex] = formData;
                } else {
                    return;
                }
            } else {
                orderData.push(formData);
            }
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
            try {
                localStorage.setItem('orderData', JSON.stringify(orderData));
                console.log('ë°ì´í„° ì €ì¥ ì™„ë£Œ:', orderData); // ë””ë²„ê¹…ìš©
                alert('ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
                
                // í¼ ì´ˆê¸°í™”
                this.reset();
                document.getElementById('date').value = new Date().toISOString().split('T')[0];
                document.getElementById('tempOrderTime').value = '09:00';
                document.getElementById('confirmedOrderTime').value = '15:00';
                
            } catch (error) {
                console.error('ì €ì¥ ì˜¤ë¥˜:', error);
                alert('ë°ì´í„° ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        });
        
        // ì •í™•ë¥  ê³„ì‚° í•¨ìˆ˜ (ìˆ˜ì •ëœ ê³µì‹: ë³€ë™ì´ ì ì„ìˆ˜ë¡ ë†’ì€ ì •í™•ë¥ )
        function calculateAccuracy(morning, confirmed, cancelled, changed) {
            if (morning === 0) return 0;
            
            // ë³€ë™ëŸ‰ ê³„ì‚° (ì·¨ì†Œ + ë³€ê²½ + ì¶”ê°€)
            const added = confirmed > morning ? confirmed - morning : 0; // ì¶”ê°€ëœ ì˜¤ë”
            const totalVariation = cancelled + changed + added;
            
            // ì •í™•ë¥  = (ê°€ì˜¤ë” - ì´ë³€ë™ëŸ‰) / ê°€ì˜¤ë” * 100
            // ë‹¨, ìµœì†Œ 0%, ìµœëŒ€ 100%ë¡œ ì œí•œ
            const accuracy = Math.max(0, Math.min(100, Math.round(((morning - totalVariation) / morning) * 100)));
            
            return accuracy;
        }
        
        // í†µê³„ í•„í„° í† ê¸€ í•¨ìˆ˜
        function toggleStatsFilters() {
            const period = document.getElementById('statsPeriod').value;
            const monthFilter = document.getElementById('monthFilter');
            const dateFilter = document.getElementById('dateFilter');
            
            if (period === 'monthly') {
                monthFilter.style.display = 'flex';
                dateFilter.style.display = 'none';
                document.getElementById('selectedMonth').value = new Date().toISOString().slice(0, 7);
            } else if (period === 'daily') {
                monthFilter.style.display = 'none';
                dateFilter.style.display = 'flex';
                document.getElementById('selectedDate').value = new Date().toISOString().split('T')[0];
            } else {
                monthFilter.style.display = 'none';
                dateFilter.style.display = 'none';
            }
            updateStatistics();
        }
        
        // ì´ë ¥ í•„í„° í† ê¸€ í•¨ìˆ˜
        function toggleHistoryFilters() {
            const period = document.getElementById('historyPeriod').value;
            const monthFilter = document.getElementById('historyMonthFilter');
            const dateFilter = document.getElementById('historyDateFilter');
            
            if (period === 'monthly') {
                monthFilter.style.display = 'flex';
                dateFilter.style.display = 'none';
                document.getElementById('historySelectedMonth').value = new Date().toISOString().slice(0, 7);
            } else if (period === 'daily') {
                monthFilter.style.display = 'none';
                dateFilter.style.display = 'flex';
                document.getElementById('historySelectedDate').value = new Date().toISOString().split('T')[0];
            } else {
                monthFilter.style.display = 'none';
                dateFilter.style.display = 'none';
            }
            filterHistory();
        }
        
        // í†µê³„ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ (í•„í„° ì ìš©)
        function updateStatistics() {
            const period = document.getElementById('statsPeriod').value;
            const selectedMonth = document.getElementById('selectedMonth').value;
            const selectedDate = document.getElementById('selectedDate').value;
            const selectedBranch = document.getElementById('statsBranch').value;
            
            // í•„í„°ë§ëœ ë°ì´í„° ìƒì„±
            let filteredData = [...orderData];
            
            // ê¸°ê°„ í•„í„° ì ìš©
            if (period === 'monthly' && selectedMonth) {
                filteredData = filteredData.filter(item => item.date.startsWith(selectedMonth));
            } else if (period === 'daily' && selectedDate) {
                filteredData = filteredData.filter(item => item.date === selectedDate);
            }
            
            // ì§€ì‚¬ í•„í„° ì ìš©
            if (selectedBranch) {
                filteredData = filteredData.filter(item => item.branch === selectedBranch);
            }
            
            if (filteredData.length === 0) {
                document.getElementById('totalOrders').textContent = '0';
                document.getElementById('avgAccuracy').textContent = '0%';
                document.getElementById('totalCancelled').textContent = '0';
                document.getElementById('totalChanged').textContent = '0';
                document.getElementById('totalAdded').textContent = '0';
                document.getElementById('branchStatsBody').innerHTML = '<tr><td colspan="6">í•´ë‹¹ ì¡°ê±´ì˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</td></tr>';
                return;
            }
            
            // ì „ì²´ í†µê³„ ê³„ì‚° (í™•ì •ì˜¤ë” ê¸°ì¤€ìœ¼ë¡œ ë³€ê²½)
            const totalOrders = filteredData.reduce((sum, item) => sum + (item.confirmedOrder || 0), 0);
            const totalCancelled = filteredData.reduce((sum, item) => sum + (item.cancelled || 0), 0);
            const totalChanged = filteredData.reduce((sum, item) => sum + (item.changed || 0), 0);
            const totalAdded = filteredData.reduce((sum, item) => sum + (item.added || 0), 0);
            
            console.log('í†µê³„ ê³„ì‚°:', { totalOrders, totalCancelled, totalChanged, totalAdded }); // ë””ë²„ê¹…ìš©
            
            const avgAccuracy = Math.round(filteredData.reduce((sum, item) => sum + (item.accuracy || 0), 0) / filteredData.length);
            
            document.getElementById('totalOrders').textContent = totalOrders.toLocaleString();
            document.getElementById('avgAccuracy').textContent = avgAccuracy + '%';
            document.getElementById('totalCancelled').textContent = totalCancelled.toLocaleString();
            document.getElementById('totalChanged').textContent = totalChanged.toLocaleString();
            document.getElementById('totalAdded').textContent = totalAdded.toLocaleString();
            
            // ì§€ì‚¬ë³„ í†µê³„ ê³„ì‚°
            const branchStats = {};
            filteredData.forEach(item => {
                if (!branchStats[item.branch]) {
                    branchStats[item.branch] = {
                        totalOrders: 0,
                        totalConfirmed: 0,
                        totalCancelled: 0,
                        totalChanged: 0,
                        totalAdded: 0,
                        accuracySum: 0,
                        count: 0
                    };
                }
                
                const stats = branchStats[item.branch];
                stats.totalOrders += (item.morningOrder || 0); // ê°€ì˜¤ë” ê¸°ì¤€
                stats.totalConfirmed += (item.confirmedOrder || 0);
                stats.totalCancelled += (item.cancelled || 0);
                stats.totalChanged += (item.changed || 0);
                stats.totalAdded += (item.added || 0);
                stats.accuracySum += (item.accuracy || 0);
                stats.count += 1;
            });
            
            // ì§€ì‚¬ë³„ í†µê³„ í…Œì´ë¸” ì—…ë°ì´íŠ¸
            const tbody = document.getElementById('branchStatsBody');
            tbody.innerHTML = '';
            
            Object.entries(branchStats).forEach(([branch, stats]) => {
                const avgAccuracy = Math.round(stats.accuracySum / stats.count);
                const cancelRate = stats.totalOrders > 0 ? Math.round((stats.totalCancelled / stats.totalOrders) * 100) : 0;
                const changeRate = stats.totalOrders > 0 ? Math.round((stats.totalChanged / stats.totalOrders) * 100) : 0;
                const addRate = stats.totalOrders > 0 ? Math.round((stats.totalAdded / stats.totalOrders) * 100) : 0;
                
                console.log(`${branch} í†µê³„:`, stats); // ë””ë²„ê¹…ìš©
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${branch}</strong></td>
                    <td>${stats.totalConfirmed.toLocaleString()}</td>
                    <td><span style="color: ${avgAccuracy >= 90 ? '#28a745' : avgAccuracy >= 70 ? '#ffc107' : '#dc3545'}">${avgAccuracy}%</span></td>
                    <td>${cancelRate}%</td>
                    <td>${changeRate}%</td>
                    <td>${addRate}%</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        // ì´ë ¥ í•„í„°ë§ í•¨ìˆ˜ (ê°œì„ ëœ ë²„ì „)
        function filterHistory() {
            const period = document.getElementById('historyPeriod').value;
            const selectedMonth = document.getElementById('historySelectedMonth').value;
            const selectedDate = document.getElementById('historySelectedDate').value;
            const selectedBranch = document.getElementById('filterBranch').value;
            
            // í•„í„°ë§ëœ ë°ì´í„° ìƒì„±
            let filteredData = [...orderData];
            
            // ê¸°ê°„ í•„í„° ì ìš©
            if (period === 'monthly' && selectedMonth) {
                filteredData = filteredData.filter(item => item.date.startsWith(selectedMonth));
            } else if (period === 'daily' && selectedDate) {
                filteredData = filteredData.filter(item => item.date === selectedDate);
            }
            
            // ì§€ì‚¬ í•„í„° ì ìš©
            if (selectedBranch) {
                filteredData = filteredData.filter(item => item.branch === selectedBranch);
            }
            
            // í…Œì´ë¸” ì—…ë°ì´íŠ¸
            const tbody = document.getElementById('historyBody');
            tbody.innerHTML = '';
            
            if (filteredData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="12">í•´ë‹¹ ì¡°ê±´ì˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</td></tr>';
                return;
            }
            
            // ë‚ ì§œìˆœìœ¼ë¡œ ì •ë ¬ (ìµœì‹ ìˆœ)
            const sortedData = filteredData.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            sortedData.forEach((item, displayIndex) => {
                const originalIndex = orderData.indexOf(item);
                const row = document.createElement('tr');
                row.setAttribute('data-index', originalIndex);
                row.innerHTML = `
                    <td>${item.date}</td>
                    <td>${item.branch}</td>
                    <td>${item.morningOrder}</td>
                    <td>${item.tempOrderTime || '-'}</td>
                    <td>${item.confirmedOrder}</td>
                    <td>${item.confirmedOrderTime || '-'}</td>
                    <td>${item.cancelled}</td>
                    <td>${item.changed}</td>
                    <td>${item.added}</td>
                    <td><span style="color: ${item.accuracy >= 90 ? '#28a745' : item.accuracy >= 70 ? '#ffc107' : '#dc3545'}">${item.accuracy}%</span></td>
                    <td style="max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${item.memo || ''}">${item.memo || '-'}</td>
                    <td>
                        <button class="edit-btn" onclick="startEdit(${originalIndex})">ìˆ˜ì •</button>
                        <button class="delete-btn" onclick="deleteRecord(${originalIndex})">ì‚­ì œ</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        // ì´ë ¥ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ (ê¸°ë³¸ ì „ì²´ ì´ë ¥ í‘œì‹œ)
        function updateHistory() {
            filterHistory(); // í•„í„° í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì „ì²´ ì´ë ¥ í‘œì‹œ
        }
        
        // ë ˆì½”ë“œ ì‚­ì œ í•¨ìˆ˜
        function deleteRecord(index) {
            if (editingIndex !== -1) {
                alert('í¸ì§‘ ì¤‘ì¸ í•­ëª©ì´ ìˆìŠµë‹ˆë‹¤. ë¨¼ì € ì €ì¥í•˜ê±°ë‚˜ ì·¨ì†Œí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (confirm('ì •ë§ë¡œ ì´ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                orderData.splice(index, 1);
                localStorage.setItem('orderData', JSON.stringify(orderData));
                updateHistory();
                updateStatistics(); // í†µê³„ë„ í•¨ê»˜ ì—…ë°ì´íŠ¸
                alert('ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // CSV ë‚´ë³´ë‚´ê¸° í•¨ìˆ˜
        function exportToCSV() {
            if (orderData.length === 0) {
                alert('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            let csv = 'ë‚ ì§œ,ì§€ì‚¬ëª…,ê°€ì˜¤ë”ìˆ˜ëŸ‰,ê°€ì˜¤ë”ì‹œê°„,í™•ì •ì˜¤ë”ìˆ˜ëŸ‰,í™•ì •ì˜¤ë”ì‹œê°„,ì·¨ì†Œ,ë³€ê²½,ì¶”ê°€,ì •í™•ë¥ ,ë©”ëª¨\n';
            orderData.forEach(item => {
                csv += `${item.date},${item.branch},${item.morningOrder},${item.tempOrderTime || ''},${item.confirmedOrder},${item.confirmedOrderTime || ''},${item.cancelled},${item.changed},${item.added},${item.accuracy}%,${item.memo || ''}\n`;
            });
            
            const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `ë°°ì°¨ì˜¤ë”_ë¶„ì„_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
        }
        
        // JSON ë‚´ë³´ë‚´ê¸° í•¨ìˆ˜
        function exportToJSON() {
            if (orderData.length === 0) {
                alert('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const blob = new Blob([JSON.stringify(orderData, null, 2)], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `ë°°ì°¨ì˜¤ë”_ë°ì´í„°_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        }
        
        // ë³´ê³ ì„œ ì¸ì‡„ í•¨ìˆ˜
        function printReport() {
            window.print();
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            console.log('í˜ì´ì§€ ë¡œë“œë¨'); // ë””ë²„ê¹…ìš©
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ë¡œë“œ
            try {
                const savedData = localStorage.getItem('orderData');
                if (savedData) {
                    orderData = JSON.parse(savedData);
                    console.log('ì €ì¥ëœ ë°ì´í„° ë¡œë“œë¨:', orderData); // ë””ë²„ê¹…ìš©
                }
            } catch (error) {
                console.error('ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
                orderData = [];
            }
            
            // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
            document.getElementById('date').value = new Date().toISOString().split('T')[0];
            
            // í˜„ì¬ ì›”ê³¼ ë‚ ì§œë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
            const today = new Date();
            const currentMonth = today.toISOString().slice(0, 7);
            const currentDate = today.toISOString().split('T')[0];
            
            document.getElementById('selectedMonth').value = currentMonth;
            document.getElementById('selectedDate').value = currentDate;
            document.getElementById('historySelectedMonth').value = currentMonth;
            document.getElementById('historySelectedDate').value = currentDate;
            
            // ì‹œê°„ ê¸°ë³¸ê°’ ì„¤ì •
            document.getElementById('tempOrderTime').value = '09:00';
            document.getElementById('confirmedOrderTime').value = '15:00';
            
            updateStatistics();
            updateHistory();
        });
    </script>
</body>
</html>